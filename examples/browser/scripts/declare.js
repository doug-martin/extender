// declare.js - v0.0.2

// Built 2012-11-28
// Copyright (c) 2012 Doug Martin (doug@dougamartin.com);
// Licensed MIT
(function(){function e(){function r(t,n){return n=n||0,e.call(t,n)}function i(e){return Object.prototype.toString.call(e)==="[object Array]"}function s(e){var t;return e!==null&&e!==t&&typeof e=="object"}function o(e){var t=s(e);return t&&e.constructor===Object}function u(e,t){var n,r;for(n in t){r=t[n];if(!(n in e)||e[n]!==r)e[n]=r}return e}function a(e,t){var n=this.__meta,r=n.supers,i=r.length,s=n.superMeta,o=s.pos;if(i>o){t&&(e=t);var u=s.name,a=s.f,f;do{f=r[o][u];if("function"==typeof f&&(f=f._f||f)!==a)return s.pos=1+o,f.apply(this,e)}while(i>++o)}return null}function f(){var e=this.__meta,t=e.supers,n=t.length,r=e.superMeta,i=r.pos;if(n>i){var s=r.name,o=r.f,u;do{u=t[i][s];if("function"==typeof u&&(u=u._f||u)!==o)return r.pos=1+i,u.bind(this)}while(n>++i)}return null}function l(e){var t=this.__getters__;return t.hasOwnProperty(e)?t[e].apply(this):this[e]}function c(e,t){var n=this.__setters__;if(!o(e))return n.hasOwnProperty(e)?n[e].apply(this,r(arguments,1)):this[e]=t;for(var i in e){var s=e[i];n.hasOwnProperty(i)?n[e].call(this,s):this[i]=s}}function h(){var e=this.__meta||{},t=e.supers,n=t.length,r=e.superMeta,i=r.pos;if(n>i){var s=r.name,o=r.f,u;do{u=t[i][s];if("function"==typeof u&&(u=u._f||u)!==o)return r.pos=1+i,u.apply(this,arguments)}while(n>++i)}return null}function p(e,t){var n=function(){var r,i=this.__meta||{},s=i.superMeta;return i.superMeta={"f":e,"pos":0,"name":t},r=e.apply(this,arguments),i.superMeta=s,r};return n._f=e,n}function d(e,t){var n=t.setters||{},r=e.__setters__,i=e.__getters__;for(var s in n)r.hasOwnProperty(s)||(r[s]=n[s]);n=t.getters||{};for(s in n)i.hasOwnProperty(s)||(i[s]=n[s]);for(var o in t)if(o!="getters"&&o!="setters"){var u=t[o];"function"==typeof u?e.hasOwnProperty(o)||(e[o]=p(h,o)):e[o]=u}}function v(){var e=r(arguments),t=e.length,n=this.prototype,i=n.__meta,s=this.__meta,o=n.__meta.bases,u=o.slice(),a=s.supers||[],f=i.supers||[];for(var l=0;l<t;l++){var c=e[l],h=c.prototype,p=h.__meta,v=c.__meta;!p&&(p=h.__meta={"proto":h||{}}),!v&&(v=c.__meta={"proto":c.__proto__||{}}),d(n,p.proto||{}),d(this,v.proto||{}),m(c.prototype,f,o),m(c,a,u)}return this}function m(e,n,r){var i=e.__meta;!i&&(i=e.__meta={});var s=e.__meta.unique;!s&&(i.unique="declare"+ ++t);if(r.indexOf(s)==-1){r.push(s);var o=e.__meta.supers||[],u=o.length-1||0;while(u>=0)m(o[u--],n,r);n.unshift(e)}}function g(e,t){var n=t.setters,r=e.__setters__,i=e.__getters__;if(n)for(var s in n)r[s]=n[s];n=t.getters||{};if(n)for(s in n)i[s]=n[s];for(s in t)if(s!="getters"&&s!="setters"){var o=t[s];if("function"==typeof o){var u=o.__meta||{};u.isConstructor?e[s]=o:e[s]=p(o,s)}else e[s]=o}}function y(e,t){return e&&t?e[t]=this:e.exports=e=this,this}function b(e){return E(this,e)}function w(e,r,s){var l=e.prototype,c=[],d="declare"+ ++t,y=[],b=[],w=[],E=[],S=l.__meta={"supers":w,"unique":d,"bases":y,"superMeta":{"f":null,"pos":0,"name":null}},x=e.__meta={"supers":E,"unique":d,"bases":b,"isConstructor":!0,"superMeta":{"f":null,"pos":0,"name":null}};o(r)&&!s&&(s=r,r=n),"function"==typeof r||i(r)?(c=i(r)?r:[r],r=c.shift(),e.__proto__=r,l.__proto__=r.prototype,l.__getters__=u({},l.__getters__||{}),l.__setters__=u({},l.__setters__||{}),e.__getters__=u({},e.__getters__||{}),e.__setters__=u({},e.__setters__||{}),m(r.prototype,w,y),m(r,E,b)):(l.__getters__=l.__getters__||{},l.__setters__=l.__setters__||{},e.__getters__=e.__getters__||{},e.__setters__=e.__setters__||{});if(s){var T=S.proto=s.instance||{};!T.hasOwnProperty("constructor")&&(T.constructor=h);var N=x.proto=s.static||{};N.init=N.init||h,g(l,T,!1),g(e,N,!0)}else S.proto={},x.proto={},e.init=p(h,"init"),l.constructor=p(h,"constructor");c.length&&v.apply(e,c),l._super=e._super=a,l._getSuper=e._getSuper=f,l._static=e}function E(e,t){function n(){this.constructor.apply(this,arguments)}return w(n,e,t),n.init()||n}function S(e,t){function r(){return n||(this.constructor.apply(this,arguments),n=this),n}var n;return w(r,e,t),r.init()||r}var e=Array.prototype.slice,t=0,n;return n=E({"instance":{"get":l,"set":c},"static":{"get":l,"set":c,"mixin":v,"extend":b,"as":y}}),E.singleton=S,E}"undefined"!=typeof exports?"undefined"!=typeof module&&module.exports&&(module.exports=e()):"function"==typeof define?define(e):this.declare=e()})();